# YDP2025_WIND_AI_Project
นี้คือ Repository สำหรับโครงการ YDP2025 ของบ่าววิน
# โปรเจกต์ทำนายการเลิกใช้บริการของลูกค้า (Customer Churn Prediction)

## 1. ภาพรวมโปรเจกต์ (Introduction)

โปรเจกต์นี้มีจุดมุ่งหมายเพื่อวิเคราะห์และสร้างโมเดล Machine Learning สำหรับทำนายว่าลูกค้าของธนาคารมีแนวโน้มที่จะเลิกใช้บริการ (Churn) หรือไม่ โดยใช้ข้อมูล `Customer-Churn-Records.csv`

เป้าหมายหลักคือการระบุปัจจัยที่ส่งผลต่อการ Churn และสร้างโมเดลที่สามารถ "ตรวจจับ" ลูกค้ากลุ่มเสี่ยงได้อย่างแม่นยำ เพื่อให้ธนาคารสามารถวางแผนการรักษาฐานลูกค้า (Retention Strategies) ได้อย่างทันท่วงที

ไฟล์ Jupyter Notebook (`YDP2025_test.ipynb`) นี้ ครอบคลุมกระบวนการทั้งหมดตั้งแต่ต้นจนจบ ตั้งแต่การสำรวจข้อมูลไปจนถึงการประเมินผลโมเดล

---

## 2. ชุดข้อมูล (Dataset)

เราใช้ชุดข้อมูล `Customer-Churn-Records.csv` ซึ่งประกอบด้วยข้อมูลลูกค้า 10,000 รายการ โดยมีรายละเอียด (Features) ต่างๆ เช่น:
* **ข้อมูลประชากร:** `Geography`, `Gender`, `Age`
* **ข้อมูลทางการเงิน:** `CreditScore`, `Balance`, `EstimatedSalary`
* **ข้อมูลการใช้บริการ:** `Tenure`, `NumOfProducts`, `HasCrCard`, `IsActiveMember`
* **ข้อมูลการร้องเรียน:** `Complain`, `Satisfaction Score`
* **ตัวแปรเป้าหมาย (Target):** `Exited` (1 = ลูกค้าเลิกใช้บริการแล้ว, 0 = ลูกค้ายังคงใช้งานอยู่)

---

## 3. กระบวนการทำงาน (Methodology)

โปรเจกต์นี้แบ่งการทำงานออกเป็นขั้นตอนหลักๆ ดังนี้:

### 3.1. การสำรวจข้อมูล (Exploratory Data Analysis - EDA)

ในขั้นตอนนี้ เราทำความเข้าใจภาพรวมของข้อมูลก่อน
* **ตรวจสอบข้อมูลพื้นฐาน:** ใช้ `.info()` และ `.isnull().sum()` เพื่อตรวจสอบชนิดข้อมูลและยืนยันว่า **ไม่มีข้อมูลสูญหาย (Missing Values)**
* **การวิเคราะห์ทางสถิติ:** ใช้ `.describe()` เพื่อดูการกระจายตัวของข้อมูลตัวเลข (เช่น ค่าเฉลี่ย, ค่าสูงสุด, ค่าต่ำสุด)
* **การสร้างกราฟ (Visualization):**
    * **กราฟสัดส่วน `Exited`:** พบว่าข้อมูลมีความ **ไม่สมดุล (Imbalanced Data)** อย่างชัดเจน โดยมีลูกค้าที่ไม่ Churn (0) มากกว่าลูกค้าที่ Churn (1) ประมาณ 4 เท่า ซึ่งการค้นพบนี้สำคัญมากต่อการเลือกโมเดลและการวัดผล
    * **กราฟเทียบ `Geography`:** พบว่าลูกค้าใน **Germany (เยอรมนี)** มีสัดส่วนการ Churn สูงกว่าประเทศอื่นอย่างมีนัยสำคัญ
    * **กราฟการกระจายตัวของ `Age`:** พบว่ากลุ่มลูกค้าวัยกลางคน (ประมาณ 40-60 ปี) มีแนวโน้ม Churn สูงกว่ากลุ่มอื่น
    * **กราฟ `Correlation Heatmap`:** เพื่อดูความสัมพันธ์ระหว่างตัวแปรต่างๆ

### 3.2. การเตรียมข้อมูล (Data Preparation & Preprocessing)

ข้อมูลดิบไม่สามารถนำไปใช้เทรนโมเดลได้ทันที เราจึงต้องเตรียมข้อมูลก่อน
1.  **ลบคอลัมน์ที่ไม่จำเป็น:** ลบ `RowNumber`, `CustomerId`, และ `Surname` ซึ่งเป็นข้อมูลระบุตัวตนที่ไม่มีผลต่อการทำนาย
2.  **กำหนดตัวแปรต้น (X) และตัวแปรตาม (y):**
    * `y` คือ `Exited` (สิ่งที่เราต้องการทำนาย)
    * `X` คือข้อมูลส่วนที่เหลือทั้งหมด
3.  **แบ่งข้อมูล (Train/Test Split):** แบ่งข้อมูลออกเป็น 80% สำหรับการเทรน (Train Set) และ 20% สำหรับการทดสอบ (Test Set)
    * เราใช้พารามิเตอร์ `stratify=y` เพื่อให้แน่ใจว่าสัดส่วนของคน Churn (0 และ 1) ในชุด Train และ Test ถูกแบ่งไปในอัตราส่วนที่เท่ากันกับข้อมูลตั้งต้น ซึ่งจำเป็นมากสำหรับข้อมูลที่ Imbalanced

### 3.3. การสร้างท่อการทำงาน (Pipeline)

เพื่อจัดการกับข้อมูลที่มีหลายประเภท (ตัวเลขและตัวอักษร) และเพื่อป้องกันข้อมูลรั่วไหล (Data Leakage) เราใช้ `Pipeline` และ `ColumnTransformer`
1.  **Numerical Features (ข้อมูลตัวเลข):**
    * ได้แก่ `CreditScore`, `Age`, `Balance`, `EstimatedSalary` ฯลฯ
    * เราใช้ `StandardScaler` เพื่อปรับสเกลของข้อมูลตัวเลขทั้งหมดให้อยู่ในมาตรฐานเดียวกัน (Mean=0, Std=1)
2.  **Categorical Features (ข้อมูลกลุ่ม/ตัวอักษร):**
    * ได้แก่ `Geography`, `Gender`, `Card Type`
    * เราใช้ `OneHotEncoder` เพื่อแปลงข้อมูลเหล่านี้ให้เป็นคอลัมน์ตัวเลข 0/1 (เช่น `Geography_France`, `Geography_Germany`, `Geography_Spain`)
3.  **ColumnTransformer:** ทำหน้าที่รวมขั้นตอนที่ 1 และ 2 เข้าด้วยกัน โดยจะแจกจ่ายข้อมูลแต่ละคอลัมน์ไปยัง Transformer ที่ถูกต้องโดยอัตโนมัติ

### 3.4. การสร้างและเปรียบเทียบโมเดล (Model Building & Comparison)

เราได้ทดลองโมเดล Classification พื้นฐาน 3 แบบ เพื่อเปรียบเทียบประสิทธิภาพเบื้องต้น:
1.  K-Nearest Neighbors (KNN)
2.  Decision Tree
3.  Random Forest

โดยโมเดล `RandomForestClassifier` ให้ผลลัพธ์ที่ดีที่สุด เราจึงเลือกโมเดลนี้ไปพัฒนาต่อ และเราได้ตั้งค่า `class_weight='balanced'` เพื่อบอกให้โมเดลช่วย "ถ่วงน้ำหนัก" ความสำคัญของคลาสส่วนน้อย (Churn) ให้มากขึ้น

### 3.5. การปรับจูนโมเดล (Hyperparameter Tuning)

หลังจากได้ Random Forest เป็นโมเดลหลัก เราใช้ `GridSearchCV` เพื่อค้นหาค่าพารามิเตอร์ (Hyperparameters) ที่ดีที่สุดสำหรับโมเดลนี้
* **ตัวชี้วัด (Scoring):** เราเลือกใช้ `f1` score เป็นเกณฑ์ในการตัดสิน (แทนที่จะเป็น `accuracy`) เนื่องจาก F1-Score เหมาะสมกว่าสำหรับการวัดผลโมเดลบนข้อมูลที่ Imbalanced

### 3.6. การประเมินผลโมเดล (Final Evaluation)

หลังจากได้โมเดลที่ดีที่สุด (Best Estimator) จาก GridSearchCV เรานำโมเดลนั้นมาทดสอบกับ Test Set (ข้อมูลที่โมเดลไม่เคยเห็นมาก่อน)
* **Accuracy:** ได้ค่าความแม่นยำโดยรวม
* **Confusion Matrix:** แสดงตารางว่าโมเดลทาย ถูก/ผิด ในแต่ละคลาส (ทายว่า Churn แต่ไม่ Churn, ทายว่าไม่ Churn แต่กลับ Churn ฯลฯ)
* **Classification Report:** แสดงผลลัพธ์โดยละเอียด โดยเฉพาะค่า **Precision**, **Recall**, และ **F1-Score** ของคลาส "Churn (1)" ซึ่งเป็นสิ่งที่เราสนใจมากที่สุด (เราอยากได้ค่า Recall สูงๆ เพื่อจับคนที่กำลังจะ Churn ให้ได้มากที่สุด)

---

## 4. วิธีการรันโปรเจกต์ (How to Run)

1.  **Clone Repository** นี้
2.  **ติดตั้ง Libraries** ที่จำเป็น (หากยังไม่มี):
    ```bash
    pip install pandas numpy matplotlib seaborn scikit-learn jupyter
    ```
3.  **เตรียมไฟล์ข้อมูล:**
    * ตรวจสอบให้แน่ใจว่าไฟล์ `Customer-Churn-Records.csv` อยู่ในตำแหน่งเดียวกับไฟล์โน้ตบุ๊ก
4.  **รันโปรเจกต์:**
    * เปิดและรันไฟล์ `YDP2025_test.ipynb` ผ่าน google colab

---

## 5. สรุปผลและสิ่งที่ได้เรียนรู้ (Conclusion)

โปรเจกต์นี้แสดงให้เห็นกระบวนการทั้งหมดในการสร้างโมเดล Customer Churn ตั้งแต่การทำความเข้าใจข้อมูล, การจัดการข้อมูลที่ Imbalanced, การใช้ Pipeline เพื่อสร้างกระบวนการที่รัดกุม, ไปจนถึงการจูนโมเดลเพื่อประสิทธิภาพสูงสุด

โมเดล Random Forest ที่ได้ สามารถระบุปัจจัยสำคัญที่ส่งผลต่อการ Churn (เช่น การเป็นลูกค้าในเยอรมนี, อายุ, การมีเงินในบัญชี) และสามารถทำนายลูกค้ากลุ่มเสี่ยงได้ด้วยความแม่นยำในระดับที่น่าพอใจ ทำให้ธนาคารสามารถนำผลลัพธ์นี้ไปต่อยอดในการวางแผนธุรกิจต่อไปได้

| ชื่อคอลัมน์               | ความหมาย                                       | ใช้ในโมเดลไหม       | เหตุผล                                                |
| ---------------------- | ---------------------------------------------- | ------------------- | ----------------------------------------------------- |
| **RowNumber**          | ลำดับแถวในตาราง (id สำหรับเรียงลำดับเฉย ๆ)         | ❌ ไม่ใช้             | ไม่มีความหมายเชิงข้อมูล                               
| **CustomerId**         | รหัสลูกค้าเฉพาะบุคคล (unique ID)                 | ❌ ไม่ใช้             | เป็นตัวระบุเฉพาะ ไม่บอกพฤติกรรม                       
| **Surname**            | นามสกุลลูกค้า                                   | ❌ ไม่ใช้             | ไม่มีผลต่อพฤติกรรมการใช้บริการ                        
| **CreditScore**        | คะแนนเครดิตทางการเงิน (ยิ่งสูงยิ่งน่าเชื่อถือ)           | ✅ ใช้               | ชี้ว่าลูกค้ามีความน่าเชื่อถือสูง → โอกาสเลิกใช้ต่ำ    
| **Geography**          | ประเทศหรือภูมิภาคที่อาศัย                          | ✅ ใช้               | พฤติกรรมลูกค้าอาจต่างกันตามภูมิภาค                    
| **Gender**             | เพศ                                          | ✅ ใช้                | เพศอาจสัมพันธ์กับพฤติกรรมการใช้บริการ                 
| **Age**                | อายุ                                          | ✅ ใช้                | ลูกค้าที่อายุมากมักมีความมั่นคงสูงกว่า                
| **Tenure**             | ระยะเวลาที่อยู่กับธนาคาร (ปี)                      | ✅ ใช้                | อยู่มานาน → loyalty สูงกว่า                           
| **Balance**            | เงินคงเหลือในบัญชี                              | ✅ ใช้                | เงินเยอะ = โอกาสเลิกใช้น้อย                           
| **NumOfProducts**      | จำนวนผลิตภัณฑ์ที่ใช้กับธนาคาร                    | ✅ ใช้                | ใช้หลายบริการ = ผูกพันมากขึ้น                        
| **HasCrCard**          | มีบัตรเครดิตหรือไม่ (1=มี, 0=ไม่มี)                 | ✅ ใช้                | ผู้ที่มีบัตรเครดิตมักไม่ย้ายง่าย                      
| **IsActiveMember**     | ใช้งานบัญชีประจำหรือไม่                          | ✅ ใช้                | ถ้าใช้งานประจำ = loyalty สูง                          
| **EstimatedSalary**    | เงินเดือนโดยประมาณ                            | ✅ ใช้                | รายได้อาจสัมพันธ์กับโอกาสเลิกใช้งาน                   
| **Exited**             | ตัวแปรเป้าหมาย (ลูกค้าเลิกใช้หรือไม่)               | 🎯 ใช้เป็น ผลลัพท์      | ผลลัพท์ที่ต้องทำนาย 1 = เลิกใช้, 0 = ยังอยู่                              
| **Complain**           | เคยร้องเรียนหรือไม่                              | ✅ ใช้                | ร้องเรียน = ความไม่พอใจ → เสี่ยงเลิกใช้สูง            
| **Satisfaction Score** | คะแนนความพึงพอใจ                             | ✅ ใช้               | คะแนนต่ำ = เสี่ยงเลิกใช้                              
| **Card Type**          | ประเภทบัตรเครดิตที่ใช้                            | ✅ ใช้               | ลูกค้าบางกลุ่มของบัตรบางประเภทอาจมี retention ต่างกัน 
| **Points Earned**      | คะแนนสะสมจากการใช้บัตร                         | ✅ ใช้               | ใช้เยอะ → engagement สูง → โอกาสเลิกใช้น้อย           
